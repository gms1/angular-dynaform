#!/bin/bash

DN=$(dirname "$0")
BN=$(basename "$0")

PROJ_HOME=$(cd "${DN}/.."; pwd)
. "${DN}/_lib.sh"


#---------------------------------------------------------

echo 'Are you shure you want to publish to npm registry (yes|no)?'
read answer
if [ "${answer}" != "yes" ]; then
  exit 0
fi

pushd "${PROJ_HOME}/packages/core/dist" &>/dev/null || \
    die "directory '${PROJ_HOME}/packages/core/dist' not found"
  npm publish || \
      die "failed to publish 'core'"
popd &>/dev/null

pushd "${PROJ_HOME}/packages/basic/dist" &>/dev/null || \
    die "directory '${PROJ_HOME}/packages/basic/dist' not found"
  npm publish || \
      die "failed to publish 'basic'"
popd &>/dev/null

pushd "${PROJ_HOME}/packages/material/dist" &>/dev/null || \
    die "directory '${PROJ_HOME}/packages/material/dist' not found"
  npm publish || \
      die "failed to publish 'material'"
popd &>/dev/null

all_plunker_build || \
  die "failed to build plunkers"

all_plunker_publish || \
  die "failed to publish plunkers"
